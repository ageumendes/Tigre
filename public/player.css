html,
body {
  margin: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: #000;
}

:root {
  --ringZ: 600px;
}

.player-root {
  width: 100vw;
  height: 100vh;
  background: #000;
  overflow: hidden;
  position: relative;
}

.stage {
  position: relative;
  width: 100vw;
  height: 100vh;
  background: #000;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

.rotWrap {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  transform: rotate(var(--rot, 0deg));
  transform-origin: center;
  transform-style: preserve-3d;
}
.carousel3d {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.ring {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 650ms cubic-bezier(.2,.8,.2,1);
  will-change: transform;
}

.layer {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transition: opacity 450ms ease;
}

.layer.is-active {
  opacity: 1;
}

.layer img,
.layer video {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.face {
  position: absolute;
  top: 50%;
  left: 50%;
  transform-style: preserve-3d;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: filter 650ms ease, opacity 650ms ease;
}

.poster,
.poster img,
.poster video {
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

.poster {
  position: absolute;
  left: 50%;
  top: 50%;
  transform-origin: center center;
}

.face img,
.face video {
  max-height: 90vh;
  max-width: 90vw;
  object-fit: contain;
  border-radius: 12px;
}

.mode-landscape .portrait-carousel .face {
  box-sizing: border-box;
  padding: 12px;
}

.mode-landscape .portrait-carousel .face img,
.mode-landscape .portrait-carousel .face video {
  max-height: 83vh;
  max-width: 83vw;
}

.portrait-carousel .ring {
  transform: rotateX(2deg);
}

.portrait-carousel .face[data-face-index="0"] {
  transform: translate(-50%, -50%) rotateY(0deg) translateZ(var(--ringZ));
}
.portrait-carousel .face[data-face-index="1"] {
  transform: translate(-50%, -50%) rotateY(45deg) translateZ(var(--ringZ));
}
.portrait-carousel .face[data-face-index="2"] {
  transform: translate(-50%, -50%) rotateY(90deg) translateZ(var(--ringZ));
}
.portrait-carousel .face[data-face-index="3"] {
  transform: translate(-50%, -50%) rotateY(135deg) translateZ(var(--ringZ));
}
.portrait-carousel .face[data-face-index="4"] {
  transform: translate(-50%, -50%) rotateY(180deg) translateZ(var(--ringZ));
}
.portrait-carousel .face[data-face-index="5"] {
  transform: translate(-50%, -50%) rotateY(225deg) translateZ(var(--ringZ));
}
.portrait-carousel .face[data-face-index="6"] {
  transform: translate(-50%, -50%) rotateY(270deg) translateZ(var(--ringZ));
}
.portrait-carousel .face[data-face-index="7"] {
  transform: translate(-50%, -50%) rotateY(315deg) translateZ(var(--ringZ));
}

.depth-front {
  opacity: 1;
  filter: none;
  z-index: 50;
}

.depth-near {
  opacity: 0.8;
  filter: brightness(0.85) saturate(0.9);
  z-index: 40;
}

.depth-mid {
  opacity: 0.45;
  filter: brightness(0.75) blur(1px);
  z-index: 30;
}

.depth-far {
  opacity: 0.2;
  filter: brightness(0.6) blur(2px);
  z-index: 20;
}

.depth-back {
  opacity: 0.08;
  filter: brightness(0.5) blur(3px);
  pointer-events: none;
  z-index: 10;
}

.depth-near img,
.depth-near video {
  transform: translateY(8%) scale(0.8);
}

.depth-mid img,
.depth-mid video {
  transform: scale(0.92);
}

.depth-far img,
.depth-far video,
.depth-back img,
.depth-back video {
  transform: scale(0.88);
}

.carousel3d.is-animating .depth-near,
.carousel3d.is-animating .depth-mid,
.carousel3d.is-animating .depth-far,
.carousel3d.is-animating .depth-back {
  filter: brightness(0.6) blur(3px);
}

.no-carousel .face {
  display: none;
}

.no-carousel .face[data-face-index="0"] {
  display: flex;
}

.controls {
  position: absolute;
  left: 50%;
  bottom: 16px;
  transform: translateX(-50%);
  display: flex;
  gap: 12px;
  padding: 12px 14px;
  background: rgba(0, 0, 0, 0.45);
  border-radius: 12px;
  backdrop-filter: blur(6px);
  z-index: 50;
  opacity: 1;
  transition: opacity 180ms ease;
}

.controls.is-hidden {
  opacity: 0;
  pointer-events: none;
}

.controls button {
  background: #ffffff;
  border: none;
  padding: 10px 16px;
  font-size: 16px;
  border-radius: 6px;
}

.mode-portrait #stage .layer {
  display: flex;
}

.mode-portrait #carousel3d {
  display: none !important;
}

.mode-landscape #stage .layer {
  display: none !important;
}

.mode-landscape #carousel3d {
  display: flex !important;
}

/* ========= PORTRAIT: SEMPRE 1 MIDIA ========= */
.screen-portrait .portrait-carousel,
.screen-portrait .carousel3d {
  perspective: none !important;
}

.screen-portrait .ring {
  transform: none !important;
}

.screen-portrait .face {
  display: none !important;
}

.screen-portrait .face[data-face-index="0"] {
  display: flex !important;
}

.screen-portrait .layer.next {
  display: none !important;
}

.screen-portrait .layer.current {
  display: block !important;
}

.screen-portrait .slot-left,
.screen-portrait .slot-right {
  display: none !important;
}

.screen-portrait img,
.screen-portrait video {
  max-width: 100% !important;
  max-height: 100% !important;
  object-fit: contain !important;
}

.screen-portrait .controls {
  left: 50% !important;
  bottom: 12px !important;
  transform: translateX(-50%) !important;
}

.single-mode .face {
  display: none !important;
}

.single-mode .face[data-face-index="0"] {
  display: flex !important;
}

.single-mode .carousel3d {
  perspective: none !important;
}

.single-mode .ring {
  transform: none !important;
}

.screen-portrait .carousel3d {
  perspective: none;
}

.screen-portrait .ring {
  transform: none !important;
}

.screen-portrait .face {
  display: none;
}

.screen-portrait .face[data-face-index="0"] {
  display: flex;
}

.screen-portrait .face img,
.screen-portrait .face video {
  max-height: 100%;
  max-width: 100%;
}

.screen-portrait .controls {
  bottom: 10px;
  gap: 10px;
  padding: 10px 12px;
}

.screen-portrait .controls button {
  padding: 10px 14px;
  font-size: 15px;
}

/* Ajustes exclusivos para LANDSCAPE (não afeta portrait). */
@media (orientation: landscape) {
  html,
  body {
    height: 100%;
    overflow: hidden !important;
  }

  :root {
    --ringZ: 640px;
    --front-max-h: 78vh;
    --front-max-w: 70vw;
    --side-max-h: 78vh;
    --near-max-w: 26vw;
    --mid-max-w: 22vw;
    --far-max-w: 18vw;
    --controls-safe: 120px;
  }

  /* 3D real no carrossel + safe area vertical para evitar corte. */
  .carousel3d {
    height: 115vh;
    max-height: 117vh;
    padding-top: 1vh;
    padding-bottom: 5vh;
    box-sizing: border-box;
    overflow: visible !important;
    perspective: 1200px;
    perspective-origin: 50% 65%;
    transform-style: preserve-3d;
  }

  /* Mantido para compatibilidade caso wrapper extra exista no HTML. */
  .ringStage {
    overflow: visible !important;
    transform-origin: center;
    transform: translateY(2vh) scale(0.90);
  }

  /* Não sobrescrevemos transform de .rotWrap/.ring para não conflitar com JS. */
  .rotWrap,
  .ring {
    transform-style: preserve-3d;
    overflow: visible !important;
  }

  .player-root,
  .stage {
    overflow: visible !important;
  }

  #carousel3d .face img,
  #carousel3d .face video {
    width: auto;
    height: auto;
    object-fit: contain !important;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  #carousel3d.no-carousel .face {
    top: 50%;
    left: 50%;
  }

  #carousel3d.no-carousel .face.depth-front {
    transform: translate(-50%, -50%) !important;
  }
}

@media (orientation: landscape) {
  :root {
    --controls-safe: 140px;
    --front-max-w: 76vw;
    --front-max-h: 80vh;
    --side-max-h: 80vh;
    --near-max-w: 26vw;
    --mid-max-w: 22vw;
    --far-max-w: 18vw;
  }

  /* sizing padrão (landscape) */
  #carousel3d .face img,
  #carousel3d .face video {
    width: auto !important;
    height: auto !important;
    object-fit: contain !important;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  /* no-carousel (landscape) garantir centralização e tamanho “front” */
  #carousel3d.no-carousel .face[data-face-index="0"] {
    transform: translate(-50%, -50%) !important;
  }
}

/* notebooks / telas menores (até ~1366x768) */
@media (orientation: landscape) and (max-width: 1366px) {
  :root {
    --controls-safe: 150px;
    --front-max-w: 86vw;
    --front-max-h: 72vh;
    --near-max-w: 30vw;
    --mid-max-w: 26vw;
    --far-max-w: 22vw;
    --side-max-h: 72vh;
  }
}

/* 720p/900p/1080p baixos */
@media (orientation: landscape) and (min-width: 1367px) and (max-width: 1599px) {
  :root {
    --controls-safe: 150px;
    --front-max-w: 82vw;
    --front-max-h: 76vh;
    --near-max-w: 28vw;
    --mid-max-w: 24vw;
    --far-max-w: 20vw;
    --side-max-h: 76vh;
  }
}

/* TV/Monitor FullHD 1920x1080 */
@media (orientation: landscape) and (min-width: 1600px) and (max-width: 2399px) {
  :root {
    --controls-safe: 140px;
    --front-max-w: 76vw;
    --front-max-h: 80vh;
    --near-max-w: 26vw;
    --mid-max-w: 22vw;
    --far-max-w: 18vw;
    --side-max-h: 80vh;
  }
}

/* 2K / QHD (2560x1440) */
@media (orientation: landscape) and (min-width: 2400px) and (max-width: 3839px) {
  :root {
    --controls-safe: 160px;
    --front-max-w: 72vw;
    --front-max-h: 82vh;
    --near-max-w: 24vw;
    --mid-max-w: 20vw;
    --far-max-w: 16vw;
    --side-max-h: 82vh;
  }
}

/* 4K (3840x2160+) */
@media (orientation: landscape) and (min-width: 3840px) {
  :root {
    --controls-safe: 190px;
    --front-max-w: 68vw;
    --front-max-h: 84vh;
    --near-max-w: 22vw;
    --mid-max-w: 18vw;
    --far-max-w: 14vw;
    --side-max-h: 84vh;
  }
}

@media (orientation: landscape) {
  #carousel3d .face.depth-front {
    height: 100% !important;
    max-height: 100% !important;
    width: auto !important;

    transform: translate(-50%, -50%) !important;

    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  #carousel3d .face.depth-front img,
  #carousel3d .face.depth-front video {
    height: 100% !important;
    max-height: 100% !important;
    width: auto !important;
    max-width: none !important;
    object-fit: contain !important;
  }
}
